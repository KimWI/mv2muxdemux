async loadFile(file) {
        document.getElementById('status').innerText = "íŒŒì¼ ë¶„ì„ ì¤‘...";
        const arrayBuffer = await file.arrayBuffer();
        const data = new Uint8Array(arrayBuffer);
        
        // 1. í—¤ë” ì‹œê·¸ë‹ˆì²˜ ë° ë²„ì „ ë¬¸ìì—´ ì¶”ì¶œ (ì—„ê²©í•œ ë°”ì´íŠ¸ ë§¤ì¹­)
        const sigText = String.fromCharCode(...data.slice(0, 8));
        const versionText = String.fromCharCode(...data.slice(16, 21));

        console.log(`[*] íŒŒì¼ ë¡œë“œ ë¨ - Signature: [${sigText}], Version: [${versionText}]`);

        // 2. 'MMCSD_MV' ì‹œê·¸ë‹ˆì²˜ (ê³µì‹ MV1 ë˜ëŠ” ê³µì‹ MV2)
        if (sigText === "MMCSD_MV") {
            if (versionText === "v1.00") {
                this.format = "MV1 (Official)";
                this.fps = 12;
                await this.parseMV1(data);
            } else if (versionText === "v2.00") {
                // ğŸ’¡ í•µì‹¬: ì—…ë¡œë“œí•˜ì‹  ê³µì‹ MV2ëŠ” í—¤ë”ê°€ 16KB(16384)ì…ë‹ˆë‹¤.
                this.format = "MV2 (Official)";
                this.fps = 15;
                await this.parseMV2(data, 16384); 
            } else {
                throw new Error(`ì•Œ ìˆ˜ ì—†ëŠ” ê³µì‹ ë²„ì „ì…ë‹ˆë‹¤: ${versionText}`);
            }
        } 
        // 3. 'MV2 ' ì‹œê·¸ë‹ˆì²˜ (ìš°ë¦¬ê°€ ë§Œë“  Python ì»¤ìŠ¤í…€ ì¸ì½”ë”)
        else if (sigText.startsWith("MV2")) {
            // ğŸ’¡ í•µì‹¬: íŒŒì´ì¬ ì»¤ìŠ¤í…€ MV2ëŠ” í—¤ë”ê°€ 512ë°”ì´íŠ¸ì…ë‹ˆë‹¤.
            this.format = "MV2 (Custom)";
            this.fps = 15;
            await this.parseMV2(data, 512);
        } 
        else {
            throw new Error(`ì§€ì›í•˜ì§€ ì•ŠëŠ” í¬ë§·ì…ë‹ˆë‹¤. (Sig: ${sigText})`);
        }
        
        document.getElementById('status').innerText = `[${this.format}] íŒŒì‹± ì™„ë£Œ! (${this.fps} FPS, ${this.totalFrames} í”„ë ˆì„)`;
        document.getElementById('btn-play').disabled = false;
    }

    // ==========================================================
    // ğŸ’¡ [Format 2] MV2 íŒŒì„œ (í—¤ë” ì˜¤í”„ì…‹ ë™ì  ì ìš©)
    // ==========================================================
    async parseMV2(data, headerSize) {
        this.frames = [];
        let offset = headerSize; // 16384(ê³µì‹) ë˜ëŠ” 512(ì»¤ìŠ¤í…€) ë¶„ê¸°
        let mp3Chunks = [];
        
        // ì»¤ìŠ¤í…€ MV2(512B í—¤ë”)ì¼ ê²½ìš°ì—ë§Œ ì²« í”„ë ˆì„ì„ 15872ë¡œ ì½ìŠµë‹ˆë‹¤.
        let isFirstFrame = (headerSize === 512);

        while (offset < data.length) {
            const blockSize = isFirstFrame ? 15872 : 16384;
            if (offset + blockSize > data.length) break;

            const pgt = data.slice(offset, offset + 6144);
            const ct = data.slice(offset + 6144, offset + 12288);
            const palRaw = data.slice(offset + 12288, offset + 12318);
            
            const sz = data[offset + 12800];
            const mp3Data = data.slice(offset + 12801, offset + 12801 + (sz * 32));
            
            const palette = this.extractPalette(palRaw, 15);
            this.frames.push({ pgt, ct, palette });
            mp3Chunks.push(mp3Data);

            offset += blockSize;
            isFirstFrame = false; // ë‘ ë²ˆì§¸ í”„ë ˆì„ë¶€í„°ëŠ” ë¬´ì¡°ê±´ 16384 ì ìš©
        }

        this.totalFrames = this.frames.length;

        // MP3 ë””ì½”ë”©
        const totalMp3Length = mp3Chunks.reduce((acc, chunk) => acc + chunk.length, 0);
        const mp3Concat = new Uint8Array(totalMp3Length);
        let writeOffset = 0;
        for (let chunk of mp3Chunks) {
            mp3Concat.set(chunk, writeOffset);
            writeOffset += chunk.length;
        }
        this.audioBuffer = await this.audioCtx.decodeAudioData(mp3Concat.buffer);
    }
